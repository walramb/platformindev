// Generated by CoffeeScript 1.6.3
(function() {
  var basehref, body, canvas, ctx, ladybug, loadimg, looptick, mainloop, preload, render, sources, tickno, tickwaitms;

  canvas = $("<canvas>");

  body = $("body");

  body.append($("<b>gotta go fast</b><br>"));

  ladybug = {
    imgsrc: 'lovely.png'
  };

  ladybug.pos = {
    x: -64,
    y: 0
  };

  ctx = canvas[0].getContext('2d');

  canvas.attr('height', 64);

  canvas.attr('width', 640);

  canvas.css('border', '1px solid black');

  tickno = 0;

  loadimg = function(src) {
    var img;
    img = new Image;
    img.src = basehref + src;
    return img;
  };

  basehref = './sprites/';

  sources = ['lovelyshorter.png', 'lovelycrouch.png', 'lovelyrun1.png', 'lovelyrun2.png', 'lovelyjump.png'];

  preload = function() {
    return sources.forEach(function(src) {
      return loadimg(src);
    });
  };

  render = function() {
    var img, jumping, lastframe, posing, src;
    ctx.fillStyle = "#008080";
    ctx.fillRect(0, 0, 640, 64);
    img = new Image();
    src = tickno % 12 > 6 ? 'lovelyrun1.png' : 'lovelyrun2.png';
    posing = tickno % 1000 < 200;
    if (posing) {
      src = tickno % 32 > 16 ? 'lovelycrouch.png' : 'lovelyshorter.png';
    }
    lastframe = 1000;
    if (tickno % lastframe < 50) {
      src = 'lovelyshorter.png';
    }
    if (tickno % 500 > 350) {
      src = 'lovelyshorter.png';
      posing = true;
      jumping = true;
    }
    if (tickno % lastframe > lastframe - 150 && jumping) {
      posing = true;
      src = 'lovelycrouch.png';
    }
    if (tickno % lastframe > lastframe - 100 && jumping) {
      posing = false;
      src = 'lovelyjump.png';
    }
    if (tickno % lastframe > lastframe - 50 && jumping) {
      posing = true;
      src = 'lovelyfall.png';
    }
    if (tickno % lastframe > lastframe - 20) {
      src = 'lovelycrouch.png';
    }
    img.src = basehref + src;
    ctx.drawImage(img, ladybug.pos.x, ladybug.pos.y);
    if (!posing) {
      ladybug.pos.x++;
    }
    if (ladybug.pos.x > 640) {
      return ladybug.pos.x = -64;
    }
  };

  looptick = function() {
    tickno++;
    return render();
  };

  tickwaitms = 10;

  mainloop = function() {
    looptick();
    return setTimeout(mainloop, tickwaitms);
  };

  body.ready(function() {
    preload();
    body.append(canvas);
    return mainloop();
  });

}).call(this);
